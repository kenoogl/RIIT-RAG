# 要件定義書

## 概要

九州大学情報基盤研究開発センターのスーパーコンピュータ（SCP）運用支援のためのRAG（Retrieval-Augmented Generation）システムのプロトタイプ。ユーザーからの質問に対して、システム説明、運用ポリシー、接続方法、バッチスクリプトの書き方、バッチキューの説明、アカウントの作り方、使用料金説明、設定方法などの情報を提供する。

## 用語集

- **RAGシステム**: Retrieval-Augmented Generationシステム。文書検索と生成AIを組み合わせた質問応答システム
- **SCP**: 九州大学のスーパーコンピュータシステム
- **文書インデックス**: 検索可能な形式で保存された文書データ
- **ベクトル検索**: 文書の意味的類似性に基づく検索手法
- **チャンク**: 文書を分割した小さな単位
- **埋め込みベクトル**: 文書の意味を数値ベクトルで表現したもの

## 要件

### 要件1

**ユーザーストーリー:** スパコンユーザーとして、システムの使い方について質問したいので、自然言語で質問して適切な回答を得たい

#### 受入基準

1. WHEN ユーザーが日本語で質問を入力する THEN RAGシステム SHALL 関連する文書を検索して回答を生成する
2. WHEN 質問に対する関連文書が存在する THEN RAGシステム SHALL 検索された文書に基づいて正確な回答を提供する
3. WHEN 質問に対する関連文書が存在しない THEN RAGシステム SHALL 適切な情報が見つからない旨を回答する
4. WHEN 回答を生成する THEN RAGシステム SHALL 参照した文書のソースを明示する
5. WHEN 複数の関連文書が存在する THEN RAGシステム SHALL 最も関連性の高い情報を統合して回答する

### 要件2

**ユーザーストーリー:** システム管理者として、九州大学SCPサイトの文書を継続的に更新したいので、文書の追加・更新・削除ができるシステムが欲しい

#### 受入基準

1. WHEN 新しい文書が追加される THEN RAGシステム SHALL 文書をチャンクに分割してインデックスに追加する
2. WHEN 既存の文書が更新される THEN RAGシステム SHALL 古いインデックスを削除して新しいインデックスを作成する
3. WHEN 文書が削除される THEN RAGシステム SHALL 対応するインデックスを削除する
4. WHEN 文書の処理が完了する THEN RAGシステム SHALL 処理結果をログに記録する
5. WHEN インデックス更新処理中にエラーが発生する THEN RAGシステム SHALL エラー内容をログに記録して処理を継続する

### 要件3

**ユーザーストーリー:** システム管理者として、九州大学SCPサイトから文書を取得したいので、指定されたWebサイトから文書を自動収集できるシステムが欲しい

#### 受入基準

1. WHEN システムが起動する THEN RAGシステム SHALL 指定されたWebサイト（https://www.cc.kyushu-u.ac.jp/scp/）から文書を取得する
2. WHEN Webページを解析する THEN RAGシステム SHALL HTMLから本文テキストを抽出する
3. WHEN 日本語以外のコンテンツが検出される THEN RAGシステム SHALL 日本語コンテンツのみを処理対象とする
4. WHEN Webサイトの構造が変更される THEN RAGシステム SHALL 変更を検出して適切に処理する
5. WHEN ネットワークエラーが発生する THEN RAGシステム SHALL エラーを記録して再試行する

### 要件4

**ユーザーストーリー:** システム管理者として、オンプレミス環境で運用したいので、外部サービスに依存しない独立したシステムが欲しい

#### 受入基準

1. WHEN システムを構築する THEN RAGシステム SHALL オンプレミス環境で完全に動作する
2. WHEN 埋め込みベクトルを生成する THEN RAGシステム SHALL ローカルの言語モデルを使用する
3. WHEN 文書を保存する THEN RAGシステム SHALL ローカルのデータベースまたはファイルシステムを使用する
4. WHEN 質問応答を処理する THEN RAGシステム SHALL ローカルの生成AIモデルを使用する
5. WHEN システムが稼働する THEN RAGシステム SHALL インターネット接続なしで動作する

### 要件5

**ユーザーストーリー:** 開発者として、システムの動作を確認したいので、検索精度と回答品質を評価できる仕組みが欲しい

#### 受入基準

1. WHEN 検索クエリが実行される THEN RAGシステム SHALL 検索結果の関連度スコアを記録する
2. WHEN 回答が生成される THEN RAGシステム SHALL 使用された文書チャンクの情報を記録する
3. WHEN システムの性能を評価する THEN RAGシステム SHALL 検索精度と回答品質の指標を提供する
4. WHEN ログを出力する THEN RAGシステム SHALL 処理時間と使用リソースを記録する
5. WHEN デバッグモードで実行される THEN RAGシステム SHALL 詳細な処理ステップを出力する